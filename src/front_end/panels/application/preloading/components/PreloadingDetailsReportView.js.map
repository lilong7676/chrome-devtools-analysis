{"version":3,"file":"PreloadingDetailsReportView.js","sourceRoot":"","sources":["../../../../../../../../front_end/panels/application/preloading/components/PreloadingDetailsReportView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2022 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../../../core/i18n/i18n.js';\nimport * as SDK from '../../../../core/sdk/sdk.js';\nimport * as ComponentHelpers from '../../../../ui/components/helpers/helpers.js';\nimport * as Coordinator from '../../../../ui/components/render_coordinator/render_coordinator.js';\nimport * as ReportView from '../../../../ui/components/report_view/report_view.js';\nimport * as LitHtml from '../../../../ui/lit-html/lit-html.js';\n\nimport preloadingDetailsReportViewStyles from './preloadingDetailsReportView.css.js';\n\ntype PrerenderingAttempt = SDK.PrerenderingModel.PrerenderingAttempt;\n\nconst UIStrings = {\n  /**\n   *@description Text in PreloadingDetailsReportView of the Application panel\n   */\n  selectAnElementForMoreDetails: 'Select an element for more details',\n  /**\n   *@description Text in grid and details\n   */\n  statusPrerendering: 'Prerendering',\n  /**\n   *@description Text in grid and details\n   */\n  statusActivated: 'Activated',\n  /**\n   *@description Text in grid and details\n   */\n  statusDiscarded: 'Discarded',\n  /**\n   *@description Text in details\n   */\n  detailsBasicInformation: 'Basic information',\n  /**\n   *@description Text in details\n   */\n  detailsStartedAt: 'Started at',\n  /**\n   *@description Text in details\n   */\n  detailsTrigger: 'Trigger',\n  /**\n   *@description Text in details\n   */\n  detailsStatus: 'Status',\n};\nconst str_ =\n    i18n.i18n.registerUIStrings('panels/application/preloading/components/PreloadingDetailsReportView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nclass PrerenderingUIUtils {\n  static trigger(x: PrerenderingAttempt): string {\n    switch (x.trigger.kind) {\n      case 'PrerenderingTriggerSpecRules':\n        return i18n.i18n.lockedString('Speculation Rules');\n      case 'PrerenderingTriggerDUI':\n        return i18n.i18n.lockedString('Direct User Input');\n      case 'PrerenderingTriggerDSE':\n        return i18n.i18n.lockedString('Default Search Engine');\n      case 'PrerenderingTriggerOpaque':\n        return i18n.i18n.lockedString('Opaque');\n    }\n  }\n\n  static status(x: PrerenderingAttempt): string {\n    switch (x.status) {\n      case SDK.PrerenderingModel.PrerenderingStatus.Prerendering:\n        return i18nString(UIStrings.statusPrerendering);\n      case SDK.PrerenderingModel.PrerenderingStatus.Activated:\n        return i18nString(UIStrings.statusActivated);\n      case SDK.PrerenderingModel.PrerenderingStatus.Discarded:\n        return i18nString(UIStrings.statusDiscarded);\n    }\n  }\n}\n\nconst coordinator = Coordinator.RenderCoordinator.RenderCoordinator.instance();\n\nexport type PreloadingDetailsReportViewData = PrerenderingAttempt|null;\n\nexport class PreloadingDetailsReportView extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-resources-preloading-details-report-view`;\n\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  #data: PreloadingDetailsReportViewData = null;\n\n  connectedCallback(): void {\n    this.#shadow.adoptedStyleSheets = [preloadingDetailsReportViewStyles];\n  }\n\n  set data(data: PreloadingDetailsReportViewData) {\n    this.#data = data;\n    void this.#render();\n  }\n\n  async #render(): Promise<void> {\n    await coordinator.write('PreloadingDetailsReportView render', () => {\n      if (this.#data === null) {\n        // Disabled until https://crbug.com/1079231 is fixed.\n        // clang-format off\n        LitHtml.render(LitHtml.html`\n          <div class=\"preloading-noselected\">\n            <div>\n              <p>${i18nString(UIStrings.selectAnElementForMoreDetails)}</p>\n            </div>\n          </div>\n        `, this.#shadow, {host: this});\n        // clang-format on\n        return;\n      }\n\n      const startedAt = new Date(this.#data.startedAt).toLocaleString();\n      const trigger = PrerenderingUIUtils.trigger(this.#data);\n      const status = PrerenderingUIUtils.status(this.#data);\n\n      // Disabled until https://crbug.com/1079231 is fixed.\n      // clang-format off\n      LitHtml.render(LitHtml.html`\n        <${ReportView.ReportView.Report.litTagName} .data=${{reportTitle: 'Prerendering Attempt'} as ReportView.ReportView.ReportData}>\n          <${ReportView.ReportView.ReportSectionHeader.litTagName}>${i18nString(UIStrings.detailsBasicInformation)}</${\n            ReportView.ReportView.ReportSectionHeader.litTagName}>\n\n          <${ReportView.ReportView.ReportKey.litTagName}>${i18n.i18n.lockedString('URL')}</${\n            ReportView.ReportView.ReportKey.litTagName}>\n          <${ReportView.ReportView.ReportValue.litTagName}>\n            <div class=\"text-ellipsis\" title=${this.#data.url}>${this.#data.url}</div>\n          </${ReportView.ReportView.ReportValue.litTagName}>\n\n          <${ReportView.ReportView.ReportKey.litTagName}>${i18nString(UIStrings.detailsStartedAt)}</${\n            ReportView.ReportView.ReportKey.litTagName}>\n          <${ReportView.ReportView.ReportValue.litTagName}>\n            <div class=\"text-ellipsis\" title=\"\">\n              ${startedAt}\n            </div>\n          </${ReportView.ReportView.ReportValue.litTagName}>\n\n          <${ReportView.ReportView.ReportKey.litTagName}>${i18nString(UIStrings.detailsTrigger)}</${\n            ReportView.ReportView.ReportKey.litTagName}>\n          <${ReportView.ReportView.ReportValue.litTagName}>\n            <div class=\"text-ellipsis\" title=\"\">\n              ${trigger}\n            </div>\n          </${ReportView.ReportView.ReportValue.litTagName}>\n\n          <${ReportView.ReportView.ReportKey.litTagName}>${i18nString(UIStrings.detailsStatus)}</${\n            ReportView.ReportView.ReportKey.litTagName}>\n          <${ReportView.ReportView.ReportValue.litTagName}>\n            ${status}\n          </${ReportView.ReportView.ReportValue.litTagName}>\n\n          ${this.#maybeDiscardedReason()}\n        </${ReportView.ReportView.Report.litTagName}>\n      `, this.#shadow, {host: this});\n      // clang-format on\n    });\n  }\n\n  #maybeDiscardedReason(): LitHtml.LitTemplate {\n    if (!this.#data) {\n      return LitHtml.nothing;\n    }\n\n    if (this.#data.discardedReason === null || this.#data.discardedReason === undefined) {\n      return LitHtml.nothing;\n    }\n\n    return LitHtml.html`\n          <${ReportView.ReportView.ReportKey.litTagName}>${i18n.i18n.lockedString('Discarded reason')}</${\n        ReportView.ReportView.ReportKey.litTagName}>\n          <${ReportView.ReportView.ReportValue.litTagName}>\n            ${this.#data.discardedReason}\n          </${ReportView.ReportView.ReportValue.litTagName}>\n    `;\n  }\n}\n\nComponentHelpers.CustomElements.defineComponent(\n    'devtools-resources-preloading-details-report-view', PreloadingDetailsReportView);\n\ndeclare global {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  interface HTMLElementTagNameMap {\n    'devtools-resources-preloading-details-report-view': PreloadingDetailsReportView;\n  }\n}\n"]}